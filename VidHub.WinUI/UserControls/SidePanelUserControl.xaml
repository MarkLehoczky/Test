<?xml version="1.0" encoding="utf-8"?>
<UserControl
    x:Class="VidHub.WinUI.UserControls.SidePanelUserControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:VidHub.WinUI.UserControls"
    xmlns:viewmodel="using:VidHub.ViewModels"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <UserControl.DataContext>
        <viewmodel:SidepanelViewModel />
    </UserControl.DataContext>

    <Grid Margin="10" Visibility="{Binding OpenPanel}">
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="auto" />
        </Grid.RowDefinitions>


        <StackPanel Grid.Row="0">
            <Grid Margin="10 0 10 5" HorizontalAlignment="Stretch">

                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <TextBlock Text="VIDEO COUNT" FontWeight="Bold" HorizontalAlignment="Left"  VerticalAlignment="Center" Grid.Column="0" />
                <TextBlock Text="{Binding VideoCount}" FontFamily="Consolas" FontWeight="Bold" HorizontalAlignment="Right" VerticalAlignment="Center" Grid.Column="1" />
            </Grid>

            <ComboBox SelectedItem="{Binding CurrentSortOption, Mode=TwoWay}" ItemsSource="{Binding SortOptions}" PlaceholderText="Sort by" Margin="0 5 0 5" HorizontalAlignment="Stretch" HorizontalContentAlignment="Stretch" />

            <TextBox Text="{Binding SearchText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" PlaceholderText="Search for a video title" Margin="0 5 0 5" HorizontalAlignment="Stretch" />

            <Grid HorizontalAlignment="Stretch">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition />
                    <ColumnDefinition />
                </Grid.ColumnDefinitions>
                <ToggleButton x:Name="DateFilter" Content="FILTER DATE" IsChecked="{Binding FilterDate, Mode=TwoWay}" Margin="0 5 5 5" HorizontalAlignment="Stretch" Grid.Column="0" />
                <ToggleButton x:Name="DurationFilter" Content="FILTER DURATION" IsChecked="{Binding FilterDuration, Mode=TwoWay}" Margin="5 5 0 5" HorizontalAlignment="Stretch" Grid.Column="1" />
            </Grid>

            <DatePicker Header="Start date" SelectedDate="{Binding StartDate, Mode=TwoWay}" IsEnabled="{Binding IsChecked, ElementName=DateFilter}" Margin="0 10 0 5" HorizontalAlignment="Stretch" />
            <DatePicker Header="End date" SelectedDate="{Binding EndDate, Mode=TwoWay}" IsEnabled="{Binding IsChecked, ElementName=DateFilter}" Margin="0 5 0 10" HorizontalAlignment="Stretch" />

            <TimePicker Header="Minimum duration" SelectedTime="{Binding MinDuration, Mode=TwoWay}" IsEnabled="{Binding IsChecked, ElementName=DurationFilter}" ClockIdentifier="24HourClock" Margin="0 10 0 5" HorizontalAlignment="Stretch" />
            <TimePicker Header="Maximum duration" SelectedTime="{Binding MaxDuration, Mode=TwoWay}" IsEnabled="{Binding IsChecked, ElementName=DurationFilter}" ClockIdentifier="24HourClock" Margin="0 5 0 0" HorizontalAlignment="Stretch" />
        </StackPanel>


        <Border Visibility="{Binding HasTransfer}" Background="#1A808080" CornerRadius="4" Padding="10" HorizontalAlignment="Stretch" VerticalAlignment="Bottom" Grid.Row="1">
            <StackPanel>
                <TextBlock Text="{Binding TransferDescription}" FontWeight="Bold" HorizontalAlignment="Center" />

                <Grid Visibility="{Binding HasActiveTransfer}" Margin="0 10 0 0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="auto" />
                    </Grid.ColumnDefinitions>
                    <TextBlock Text="{Binding LoadedCount}" FontFamily="Consolas" Grid.Column="0" />
                    <ProgressBar Minimum="0" Value="{Binding LoadedCount}" Maximum="{Binding TotalCount}" IsIndeterminate="{Binding Indeterminate}" Margin="10 0" Grid.Column="1" />
                    <TextBlock Text="{Binding TotalCount}" FontFamily="Consolas" Grid.Column="2" />
                </Grid>

            </StackPanel>
        </Border>
        

    </Grid>
    
</UserControl>
